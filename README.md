Recaps Switcher – изменения
===========================
Легендарный переключатель раскладок для winwods по клавише capslock
исходная программа несколько устаревшая, периодически зависает\крашится на win10 x64. 
Автор был уведомлен и получил ссылку на этот репозиторий c багфиксами.

Этот форк содержит минимальные доработки относительно [оригинальной программы](https://recaps.sourceforge.io/index_ru.html):

1. **Синхронизация доступа к спискам раскладок и хоткеев.**  
   Добавлен `CRITICAL_SECTION` и RAII-guard `LayoutsGuard`, что устраняет гонки между низкоуровневым хуком и обработкой уведомлений о смене раскладок.

2. **Поток ремапинга хоткеев.**  
   Вместо `SuspendThread/ResumeThread` используется `_beginthreadex` + событие для пробуждения, добавлено корректное завершение и освобождение ресурсов при выходе приложения.

3. **Конвертация текста и работа с буфером обмена.**  
   Функция `ConvertSelectedTextInActiveWindow` теперь:
   - использует таймауты `SendMessageTimeout`;
   - имеет ретраи для `OpenClipboard`;
   - безопасно обрабатывает пустой/занятый буфер обмена и не падает при отсутствии данных;
   - корректно восстанавливает буфер только при успешном сохранении.

4. **Сборка на x64.**  
   Исправлены касты HKL/HINSTANCE → `int`, добавлены helper’ы для безопасного сохранения/загрузки HKL из реестра, устранены критичные предупреждения компилятора (отсутствующие `return`, узкие преобразования).

5. **Вспомогательные улучшения.**  
   Добавлены проверки ввода в функциях буфера обмена, зануление структур, освобождение памяти только при успешном выделении.

### Что осталось без изменений
- Логика UI, набор хоткеев и конфигурация совпадают с оригиналом.
- Преформатирование, локализация и ресурсы не затрагивались.

Подробнее о сборке см. `runbook.md`.
